## 存储策略规则

各个数据类别的存储策略按类别存放于此，子目录名即为类别值。

其中包含4个配置文件：

1. `whitelist.json` 白名单。可选。
2. `blacklist.json` 黑名单。可选。
3. `ploy.go`  Go语言编写的策略定制。可选。
4. `ploy.lua` Lua语言编写的策略定制。可选。

> **说明：**
> 黑白名单中的匹配式为目标ID的16进制表示，支持正则表达式（如 `.*`）。
> 目标ID并不是实际的数据ID，已通过 `Hash（数据ID + Seed）` 变换以保护隐私。
> 用户可在配置文件 `config.hjson` 中指定Seed（`ploy_seed`）。

注意，如果所有的配置都不存在，默认不会存储任何数据！


### 检查过程

上级调用者首先检查**白名单**，如果匹配则返回，表示必然存储。否则检查**黑名单**，如果匹配也返回，但肯定不存储。

两个名单检查结束后，执行下面的策略检查。

1. 检查 `ploy.go` 及其中的 Ploy 函数：
    - 存在：调用执行。返回的结果决定是否存储。
    - 不存在：检查 `ploy.lua` 文件及其中的 ploy 函数。
2. 如果 `ploy.lua` 存在并有 ploy 函数，调用执行。结果表示是否存储。

`ploy.go` 和 `ploy.lua` 为平级关系，只要有一个定义即可。用户可以根据自己的偏好使用这两种语言。

上级调用者传递到 `Ploy` 或 `ploy` 函数中的ID是原始请求的数据ID，未加变换（但会同时传递 `Seed`）。


### 0：存档类（Archives）

存储策略通常较为简单，只是限定一定规模下的随机选择。


### 1：区块链（Blockqs）

数据ID包含特定的内部结构，通常首字节定义了请求的类别。详见设计文档。

但对区块链数据的存储，通常由内部的 Blockqs 节点直接负责。对于离散的驿站（数据网络）请求，它们通常只是提供而非接收数据。
因此在区块链的存储策略配置中，通常是在黑名单中定义一个 `.*`，阻断*紧缺性感知机制*下的存储。

> **提示：**
> 一个驿站支持的区块链通常是有选择的。
> 对区块数据的存储，需要根据区块头链和客户端提交的区块进行验证才能判断。
> 长期来看，Blockqs服务节点通常只会与自身支持的区块链的节点建立连接（并提供服务）。
